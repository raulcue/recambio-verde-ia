<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8"><title>Logs - Admin</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body class="bg-slate-50 min-h-screen">
    <nav class="h-16 bg-white border-b flex items-center justify-between px-8">
        <div class="flex items-center gap-4">
            <a href="landing.html" class="text-slate-400"><i class="fas fa-arrow-left"></i></a>
            <h1 class="font-black uppercase text-slate-800 tracking-tighter">Historial</h1>
        </div>
    </nav>
    <main class="p-8 max-w-6xl mx-auto">
        <div class="bg-white rounded-[40px] shadow-sm border border-slate-100 overflow-hidden">
            <table class="w-full text-left">
                <thead class="bg-slate-50 border-b"><tr class="text-[10px] font-black uppercase text-slate-400">
                    <th class="p-6">Fecha</th><th class="p-6">Usuario</th><th class="p-6">Pedido</th><th class="p-6">Acci√≥n</th>
                </tr></thead>
                <tbody id="logsTable" class="divide-y"></tbody>
            </table>
        </div>
    </main>
    <script>
        async function loadLogs() {
            try {
                const res = await fetch('/api/admin/logs');
                const contentType = res.headers.get("content-type");
                if (res.ok && contentType && contentType.includes("application/json")) {
                    const logs = await res.json();
                    document.getElementById('logsTable').innerHTML = logs.map(log => `
                        <tr>
                            <td class="p-6 text-xs text-slate-400">${new Date(log.fecha).toLocaleString()}</td>
                            <td class="p-6 text-xs font-black uppercase">${log.email || 'Sistema'}</td>
                            <td class="p-6 text-[10px] font-black text-blue-600 uppercase">${log.numero_pedido || '---'}</td>
                            <td class="p-6 text-xs italic">${log.accion}</td>
                        </tr>`).join('');
                }
            } catch (e) { console.warn("Error en logs"); }
        }
        loadLogs(); setInterval(loadLogs, 30000);
    </script>
</body>
</html>
