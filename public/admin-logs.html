<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Logs de Actividad - Admin</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body class="bg-slate-50 min-h-screen">
    <nav class="h-16 bg-white border-b flex items-center justify-between px-8">
        <div class="flex items-center gap-4">
            <a href="/dashboard" class="text-slate-400 hover:text-slate-800"><i class="fas fa-arrow-left"></i></a>
            <h1 class="font-black uppercase text-slate-800 tracking-tighter">Historial de Actividad</h1>
        </div>
        <button onclick="window.location.reload()" class="p-2 text-slate-400 hover:rotate-180 transition-all duration-500">
            <i class="fas fa-sync-alt"></i>
        </button>
    </nav>

    <main class="p-8 max-w-6xl mx-auto">
        <div class="bg-white rounded-[40px] shadow-sm border border-slate-100 overflow-hidden">
            <table class="w-full text-left border-collapse">
                <thead>
                    <tr class="bg-slate-50 border-b border-slate-100">
                        <th class="p-6 text-[10px] font-black uppercase text-slate-400 italic">Fecha y Hora</th>
                        <th class="p-6 text-[10px] font-black uppercase text-slate-400 italic">Usuario</th>
                        <th class="p-6 text-[10px] font-black uppercase text-slate-400 italic">Pedido</th>
                        <th class="p-6 text-[10px] font-black uppercase text-slate-400 italic">Acción Realizada</th>
                    </tr>
                </thead>
                <tbody id="logsTable" class="divide-y divide-slate-50">
                    </tbody>
            </table>
        </div>
    </main>

    <script>
        async function loadLogs() {
            const res = await fetch('/api/admin/logs');
            const logs = await res.json();
            const table = document.getElementById('logsTable');
            
            table.innerHTML = logs.map(log => `
                <tr class="hover:bg-slate-50/50 transition-colors">
                    <td class="p-6 text-xs text-slate-400 font-medium">
                        ${new Date(log.fecha).toLocaleString('es-ES')}
                    </td>
                    <td class="p-6">
                        <span class="text-xs font-black text-slate-700 uppercase">${log.email || 'Sistema'}</span>
                    </td>
                    <td class="p-6">
                        <span class="px-3 py-1 bg-blue-50 text-blue-600 rounded-full text-[10px] font-black uppercase">
                            ${log.numero_pedido || 'N/A'}
                        </span>
                    </td>
                    <td class="p-6">
                        <p class="text-xs text-slate-600 italic font-medium">${log.accion}</p>
                    </td>
                </tr>
            `).join('');
        }
        loadLogs();
        // Recarga automática cada 30 segundos
        setInterval(loadLogs, 30000);
    </script>
</body>
</html>
